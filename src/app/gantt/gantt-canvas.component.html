<!-- src/app/gantt/gantt-canvas.component.html -->

<!-- ВЕРХНИЙ TOOLBAR -->
<div class="page-toolbar">
  <div class="proj-ops">
    <button type="button" (click)="addRandomNode()">+ Add Random Node</button>
    <button type="button" (click)="expandAll()" title="Expand all">Expand all</button>
    <button type="button" (click)="collapseAll()" title="Collapse all">Collapse all</button>
  </div>

  <div class="gantt-toolbar">
    <!-- Группы управления Гантом показываем только если showGantt -->
    <div class="zoom" *ngIf="showGantt">
      <button type="button" (click)="bumpScale(-1)" title="Zoom out">−</button>
      <input type="range" min="4" max="60" step="1" [value]="ganttPxPerDay" (input)="onTimescaleInput($event)" />
      <button type="button" (click)="bumpScale(1)" title="Zoom in">+</button>
      <button type="button" (click)="zoomToFit()" title="Zoom to fit all tasks">Fit</button>
      <span class="zoom-label">Timescale</span>
    </div>

    <select *ngIf="showGantt" [value]="ganttScale" (change)="onScaleChange($event)">
      <option value="week-day">week | day</option>
      <option value="month-week">month | week</option>
      <option value="quarter-month">quarter | month</option>
      <option value="year-month">year | month</option>
      <option value="year-quarter">year | quarter</option>
    </select>

    <button type="button" (click)="toggleGantt()">
      {{ showGantt ? 'Скрыть Gantt' : 'Показать Gantt' }}
    </button>
  </div>
</div>

<!-- ОСНОВНОЕ СОДЕРЖИМОЕ -->
<div class="center">
  <div #splitRoot class="split-root">
    <!-- Левая панель: Таблица -->
    <div class="pane pane-left" [style.flex-basis.%]="showGantt ? leftPct : 100">
      <div #host class="wbs-host">
        <canvas #headerCanvas class="wbs-header-canvas"></canvas>
        <div #bodyWrapper class="wbs-body-wrapper">
          <canvas #canvas></canvas>
        </div>
      </div>
    </div>

    <!-- Разделитель -->
    <div
      class="splitter"
      (mousedown)="onSplitMouseDown($event)"
      [style.display]="showGantt ? '' : 'none'">
    </div>

    <!-- Правая панель: Гантт -->
    <div
      class="pane pane-right"
      [style.flex-basis.%]="100 - leftPct"
      [style.display]="showGantt ? '' : 'none'">
      <div #ganttHost class="gantt-host">
        <canvas #ganttHeaderCanvas class="wbs-header-canvas"></canvas>
        <div #ganttWrapper class="wbs-body-wrapper">
          <canvas #ganttCanvas></canvas>
        </div>
      </div>
    </div>
  </div>
</div>